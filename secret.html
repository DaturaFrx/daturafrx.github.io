<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>·</title><style>
body {
  background: #111;
  color: #eee;
  font-family: monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 2rem;
  margin: 0;
}
input, button {
  margin: 0.5rem 0;
  padding: 0.75rem;
  font-size: 1rem;
  font-family: monospace;
  width: 90%;
  max-width: 400px;
  box-sizing: border-box;
}
#o {
  margin-top: 1rem;
  white-space: pre-wrap;
  word-break: break-word;
  width: 90%;
  max-width: 400px;
  text-align: center;
}
</style></head><body>
password:<br><input type="password" id="p"><br><button id="g">go</button><div id="o"></div>
<script>
const S="6cdeeca3c080b00952f616f54e97e40df60af2284dae563ac79ae1fd50393a3cd663e6dafeec957e8f3431d8a03e24d24b90eb318df7591b5c9eed45ab138186",
I=100000,E="19qlJ4hCGZ/jM7jizkSY0B22cqDv6IQqsmJ9oc5R9KjP4n0y68/YLyc9DEBdIppYUNy2EhxS44Kjs134qBxSOG07mu6j060Ka/iUDsywZbx7dvVa9JvfMtHONzdgqrBaDoT+o61QraP4DGBXcn9Ebwr1+O4esShg8CWFdS+wpeRlgBH26jiOkEEOnMS9lA==";
function h(b){return Array.from(new Uint8Array(b)).map(x=>x.toString(16).padStart(2,"0")).join("")}
function b64(u){let s=atob(u),a=new Uint8Array(s.length);for(let i=0;i<s.length;i++)a[i]=s.charCodeAt(i);return a}
async function dcm(p,a){
  let s=a.slice(0,16),n=a.slice(16,32),t=a.slice(32,48),c=a.slice(48),
  km=await crypto.subtle.importKey("raw",new TextEncoder().encode(p),{name:"PBKDF2"},!1,["deriveKey"]),
  k=await crypto.subtle.deriveKey({name:"PBKDF2",salt:s,iterations:I,hash:"SHA-512"},km,{name:"AES-GCM",length:256},!1,["decrypt"]),
  ctt=new Uint8Array(c.length+t.length);ctt.set(c,0),ctt.set(t,c.length);
  let d=await crypto.subtle.decrypt({name:"AES-GCM",iv:n,tagLength:128},k,ctt);
  return new TextDecoder().decode(d)
}
let A=b64(E);
document.getElementById("g").onclick=async()=>{
  let o=document.getElementById("o"),p=document.getElementById("p").value; o.textContent="…";
  try{
    let hv=await crypto.subtle.digest("SHA-512",new TextEncoder().encode(p)),hh=h(hv);
    if(hh!==S)throw"mismatch";
    o.textContent="OK:\n"+await dcm(p,A)
  }catch(e){o.textContent="Err:"+e}
};
</script></body></html>
